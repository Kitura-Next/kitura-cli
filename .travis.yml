language: go
go:
  - 1.12.x

branches:
  only:
    - master
    - "/^issue.*$/"
    - /^\d+.\d+.\d+$/

os:
  - linux
  - osx
osx_image: xcode11
dist: xenial
sudo: required

script:
  - "./build.sh ${TRAVIS_TAG:-0.0.1}"

deploy:
  provider: releases
  api_key: "GITHUB OAUTH TOKEN"
  file: 
   - kitura-cli_${TRAVIS_TAG}_amd64.deb
   - kitura-cli_${TRAVIS_TAG}_darwin.tar.gz
   - install.sh
   - kitura.rb
  skip_cleanup: true
  on:
    tags: true
    repo: Kitura-Next/kitura-cli
